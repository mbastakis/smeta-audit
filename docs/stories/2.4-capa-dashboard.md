# Story 2.4: CAPA Tracker Dashboard UI

## Status
**Ready for Review**

## Story
**As an** HR manager,  
**I want** a CAPA tracker interface to view and manage corrective actions,  
**so that** I can demonstrate our continuous improvement process to the auditor.

## Acceptance Criteria
1. CAPA Tracker page accessible from dashboard card, displays two-column layout: CAPA list (left 40%) and details panel (right 60%)
2. CAPA list shows all CAPAs with color-coded status badges: Red (Critical/Overdue), Orange (Major), Yellow (Minor), Green (Closed)
3. List items display: CAPA ID, Description (truncated to 60 chars), Status, Due date (if open)
4. Filter buttons above list: "All", "Open", "In Progress", "Closed" (calls appropriate API endpoint)
5. Sort dropdown: "Due Date", "Status", "Severity" (client-side sorting)
6. Click CAPA in list → highlights item and loads details in right panel
7. Details panel shows all CAPA fields in read-only format with labels: CAPA ID, Description, Pillar, Severity, Status, Dates, Root Cause, Corrective Action, Preventive Action
8. "Add CAPA" button (top-right) opens create modal (Story 2.5)
9. Edit button in details panel opens edit modal (Story 2.5)
10. Delete button shows confirmation dialog, on confirm calls DELETE API and refreshes list
11. Empty state: "No CAPAs found" with "Add CAPA" button if list is empty

## Tasks / Subtasks
- [x] Create CAPATracker page with two-column layout
- [x] Implement CAPA list with color-coded badges
- [x] Add filter buttons
- [x] Add sort dropdown
- [x] Implement details panel
- [x] Add Add/Edit/Delete actions
- [x] Add loading and empty states

---

## Dev Agent Record

### Agent Model Used
Claude 3.7 Sonnet (opencode)

### Debug Log References
None - Implementation completed successfully

### Completion Notes
- Created CAPA TypeScript interfaces matching backend data models
- Built capaService with full CRUD operations (getAll, getByStatus, getById, create, update, delete)
- Implemented CAPATracker page with responsive two-column layout (40% list, 60% details)
- CAPA list displays color-coded status badges:
  - Red (#e53e3e): Critical severity or overdue items
  - Orange (#dd6b20): Major severity
  - Yellow (#ecc94b): Minor severity
  - Green (#38a169): Closed status
  - Blue (#4299e1): In-progress default
- List items show CAPA ID, truncated description (60 chars), status chip, and due date
- Filter buttons (All, Open, In Progress, Closed) - calls appropriate API endpoints
- Sort dropdown (Due Date, Status, Severity) - client-side sorting with proper ordering
- Click CAPA in list → highlights and loads full details in right panel
- Details panel displays all CAPA fields in read-only format with proper labels
- Add CAPA button (placeholder for Story 2.5)
- Edit button (placeholder for Story 2.5)
- Delete button with confirmation dialog - calls DELETE API and refreshes list
- Empty state with "No CAPAs found" message and Add button
- Loading state with skeleton cards
- Auto-selects first CAPA when list loads
- All tests passing (12/12)

### File List
**New Files Created:**
- `frontend/src/types/capa.ts` - TypeScript interfaces for CAPA data models
- `frontend/src/services/capaService.ts` - API client for CAPA operations
- `frontend/src/pages/CAPATracker.tsx` - Main CAPA tracker page with two-column layout
- `frontend/tests/CAPATracker.test.ts` - Unit tests for CAPA tracker logic

**Modified Files:**
- `frontend/src/App.tsx` - Added /capa route for CAPA tracker page

---

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| Oct 28, 2025 | 1.0 | Story created from PRD | Sarah (PO) |
| Oct 28, 2025 | 1.1 | Story implemented - CAPA Tracker UI complete | James (Dev) |
