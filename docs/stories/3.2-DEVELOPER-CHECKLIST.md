# Story 3.2: Repository Cleanup - Developer Checklist

**Developer:** _________________  
**Start Date:** _________________  
**Target Completion:** 4-6 hours  
**Story File:** `docs/stories/3.2-project-cleanup-refactor.md`

---

## ⚠️ BEFORE YOU START

### Prerequisites
- [ ] Read full story: `docs/stories/3.2-project-cleanup-refactor.md`
- [ ] Reviewed Winston's analysis (embedded in story)
- [ ] Confirmed you have 4-6 hours available
- [ ] All current work committed or stashed

### Create Backup
```bash
# Create backup branch (CRITICAL - do this first!)
git checkout -b cleanup/pre-3.2-backup
git push origin cleanup/pre-3.2-backup

# Create working branch
git checkout main
git pull origin main
git checkout -b feature/3.2-cleanup

echo "✅ Backup created. Safe to proceed."
```

---

## PHASE 1: ELECTRON ARTIFACTS REMOVAL (1 hour)

### Delete .electron-temp/ Directory
```bash
# Verify directory exists
ls -la .electron-temp/

# Delete entire directory
rm -rf .electron-temp/

# Verify deletion
ls -la .electron-temp/  # Should error: No such file or directory
```
- [ ] `.electron-temp/` deleted
- [ ] Verified deletion

### Delete Electron Scripts
```bash
# Delete all at once
rm -f build-all-platforms.sh \
      build-electron-frontend.sh \
      copy-data-to-electron.sh \
      kill-and-launch.sh \
      launch-electron.sh \
      rebuild-and-launch.sh \
      rebuild-electron.sh \
      quick-rebuild.sh \
      final-test-electron.sh \
      electron-frontend.env

# Verify deletion
ls -1 *.sh | grep -E '(build|electron|launch|rebuild)' 
# Should return nothing

ls -1 | grep electron
# Should return nothing
```
- [ ] All 10 electron files deleted
- [ ] Verified no electron scripts remain

### Delete Temporary Scripts
```bash
# PDF fix scripts
rm -f fix-pdf-cdn.js \
      fix-pdf-paths.js \
      fix-pdf-viewer.sh \
      sync-pdf-fix.js \
      test-pdf-fix.sh

# Test artifacts
rm -f test-file.txt \
      test-display-name.txt \
      test-unified.sh

# Verify deletion
ls -1 | grep -E '(fix-|test-|sync-)'
# Should return nothing
```
- [ ] All 8 temporary files deleted
- [ ] Verified deletion

### Update .gitignore (Part 1)
```bash
# Add to .gitignore
cat >> .gitignore << 'EOF'

# ========================================
# Story 3.2: Cleanup Patterns
# ========================================

# Electron build artifacts
.electron-temp/
*-electron-*.sh
electron-frontend.env

# Temporary debugging scripts
*-fix.js
*-fix.sh
sync-*.js

# Test artifacts
test-*.txt
test-*.sh

EOF
```
- [ ] Patterns added to .gitignore
- [ ] Verified patterns work (test with `touch test-debug.txt && git status`)

### Verify No Broken References
```bash
# Search for references to deleted files
git grep "electron-temp"     # Should return nothing
git grep "build-electron"    # Should return nothing
git grep "fix-pdf"          # Should return nothing
git grep "test-unified"     # Should return nothing
```
- [ ] No broken references found
- [ ] All searches return empty

### Commit Phase 1
```bash
git add -A
git status  # Review what will be committed

git commit -m "chore: Remove obsolete electron artifacts and temp scripts

- Delete .electron-temp/ directory with all contents
- Remove 10 electron build/launch scripts
- Remove 5 PDF debugging scripts (fix-pdf-*, sync-pdf-*)
- Remove 3 test artifact files (test-*.txt, test-unified.sh)
- Add cleanup patterns to .gitignore

Rationale: Post-merge cleanup after electron integration. These
files are no longer needed and clutter the repository.

Files deleted: 18 scripts + .electron-temp/ directory
See Story 3.2 AC#1 and AC#2."

git log -1 --stat  # Verify commit
```
- [ ] Changes reviewed
- [ ] Committed successfully
- [ ] Commit message is clear

**✅ PHASE 1 COMPLETE** - Take a 5-minute break!

---

## PHASE 2: DOCUMENTATION ORGANIZATION (30 min)

### Create Process Documentation Directory
```bash
mkdir -p docs/process/
ls -la docs/process/  # Verify created
```
- [ ] `docs/process/` directory created

### Move Process Documentation Files
```bash
# Use git mv to preserve history
git mv MERGE_COMPLETE.md docs/process/
git mv MERGE_STRATEGY.md docs/process/
git mv ELECTRON_IMPLEMENTATION_GUIDE.md docs/process/

# Verify moves
ls -1 docs/process/
# Should show:
# MERGE_COMPLETE.md
# MERGE_STRATEGY.md
# ELECTRON_IMPLEMENTATION_GUIDE.md

ls -1 *.md
# Should NOT show the moved files
```
- [ ] MERGE_COMPLETE.md moved
- [ ] MERGE_STRATEGY.md moved
- [ ] ELECTRON_IMPLEMENTATION_GUIDE.md moved
- [ ] Verified files in new location

### Search for References to Moved Files
```bash
# Find references in other files
git grep "MERGE_COMPLETE.md" --exclude-dir=docs/process
git grep "MERGE_STRATEGY.md" --exclude-dir=docs/process
git grep "ELECTRON_IMPLEMENTATION" --exclude-dir=docs/process

# Update any found references to new paths
# (Use your editor's find/replace if needed)
```
- [ ] Searched for references
- [ ] Updated any found references (if any)
- [ ] No broken links remain

### Update README if Needed
```bash
# Check if README references moved files
grep -E "(MERGE_|ELECTRON_IMPLEMENTATION)" README.md

# If found, update README.md with new paths
# Example: MERGE_COMPLETE.md → docs/process/MERGE_COMPLETE.md
```
- [ ] README checked
- [ ] README updated if needed
- [ ] No broken references

### Commit Phase 2
```bash
git add -A
git status

git commit -m "docs: Organize process documentation in docs/process/

- Create docs/process/ directory for development process docs
- Move MERGE_COMPLETE.md to docs/process/
- Move MERGE_STRATEGY.md to docs/process/
- Move ELECTRON_IMPLEMENTATION_GUIDE.md to docs/process/
- Update all references to new paths

Rationale: Process documentation should be organized in docs/
rather than cluttering root directory. This improves project
organization and makes it easier to find relevant documentation.

See Story 3.2 AC#3."
```
- [ ] Committed successfully
- [ ] Only README.md remains at root

**✅ PHASE 2 COMPLETE**

---

## PHASE 3: PRODUCTION SCRIPTS CREATION (1.5 hours)

### Create START_PLATFORM.bat (Windows)
```bash
# Create the file
cat > START_PLATFORM.bat << 'EOF'
@echo off
cls
echo ========================================
echo   SMETA Compliance Platform
echo   Starting application...
echo ========================================

REM Check if Node.js is installed
node --version >nul 2>&1
if errorlevel 1 (
    echo ERROR: Node.js is not installed!
    echo Please install Node.js from https://nodejs.org/
    pause
    exit /b 1
)

REM Navigate to backend directory
cd /d "%~dp0backend"

REM Check if backend is built
if not exist "dist\server.js" (
    echo ERROR: Backend not built! Run 'npm run build' first.
    cd ..
    pause
    exit /b 1
)

REM Set environment to production
set NODE_ENV=production

REM Start the server
echo Starting server on http://localhost:5001...
echo.
start "SMETA Platform Server" /MIN cmd /k "node dist/server.js"

REM Wait for server to start
timeout /t 3 /nobreak >nul

REM Open browser
echo Opening browser...
start http://localhost:5001

echo.
echo ========================================
echo   Platform is running!
echo ========================================
echo.
echo The application is now running at:
echo http://localhost:5001
echo.
echo To stop the server, close the "SMETA Platform Server" window.
echo.
pause
EOF
```
- [ ] START_PLATFORM.bat created
- [ ] File contains correct code

### Create start-platform.sh (Mac/Linux)
```bash
# Create the file
cat > start-platform.sh << 'EOF'
#!/bin/bash

echo "========================================"
echo "  SMETA Compliance Platform"
echo "  Starting application..."
echo "========================================"

# Check if Node.js is installed
if ! command -v node &> /dev/null; then
    echo "ERROR: Node.js is not installed!"
    echo "Please install Node.js from https://nodejs.org/"
    exit 1
fi

# Navigate to backend directory
cd "$(dirname "$0")/backend"

# Check if backend is built
if [ ! -f "dist/server.js" ]; then
    echo "ERROR: Backend not built! Run 'npm run build' first."
    cd ..
    exit 1
fi

# Set environment to production
export NODE_ENV=production

# Start the server
echo "Starting server on http://localhost:5001..."
echo ""
node dist/server.js &
SERVER_PID=$!

# Wait for server to start
sleep 3

# Check if server is still running
if ! ps -p $SERVER_PID > /dev/null; then
    echo "ERROR: Server failed to start!"
    exit 1
fi

# Open browser
echo "Opening browser..."
if [[ "$OSTYPE" == "darwin"* ]]; then
    # macOS
    open http://localhost:5001
elif [[ "$OSTYPE" == "linux-gnu"* ]]; then
    # Linux
    xdg-open http://localhost:5001 2>/dev/null
fi

echo ""
echo "========================================"
echo "  Platform is running!"
echo "========================================"
echo ""
echo "The application is now running at:"
echo "http://localhost:5001"
echo ""
echo "Server PID: $SERVER_PID"
echo "Press Ctrl+C to stop the server."
echo ""

# Handle Ctrl+C gracefully
trap "echo 'Stopping server...'; kill $SERVER_PID 2>/dev/null; exit" INT TERM

# Wait for server process
wait $SERVER_PID
EOF

# Make executable
chmod +x start-platform.sh
```
- [ ] start-platform.sh created
- [ ] File contains correct code
- [ ] Made executable (`chmod +x`)

### Test START_PLATFORM.bat (Windows Only)
**Skip if on Mac/Linux - note "Not tested on Windows" in commit**

If on Windows:
```bash
# First ensure backend is built
cd backend
npm run build
cd ..

# Test the script
START_PLATFORM.bat

# Verify:
# - Node.js version check works
# - Server starts
# - Browser opens to http://localhost:5001
# - Dashboard loads
# - Can upload a test document
# - Can view the document
# - Server window stays open

# Close server window when done testing
```
- [ ] Script tested on Windows (or marked N/A)
- [ ] Server starts successfully
- [ ] Browser opens automatically
- [ ] Dashboard loads without errors
- [ ] Basic functionality works

### Test start-platform.sh (Mac/Linux Only)
**Skip if on Windows - note "Not tested on Mac/Linux" in commit**

If on Mac/Linux:
```bash
# First ensure backend is built
cd backend
npm run build
cd ..

# Test the script
./start-platform.sh

# Verify:
# - Node.js version check works
# - Server starts (shows PID)
# - Browser opens to http://localhost:5001
# - Dashboard loads
# - Can upload a test document
# - Can view the document
# - Ctrl+C stops server gracefully

# Press Ctrl+C to stop when done testing
```
- [ ] Script tested on Mac/Linux (or marked N/A)
- [ ] Server starts successfully
- [ ] Browser opens automatically
- [ ] Dashboard loads without errors
- [ ] Basic functionality works
- [ ] Ctrl+C stops server

### Commit Phase 3
```bash
git add START_PLATFORM.bat start-platform.sh
git status

git commit -m "feat: Add production startup scripts for Windows and Mac/Linux

- Create START_PLATFORM.bat for Windows deployment
- Create start-platform.sh for Mac/Linux deployment
- Both scripts check for Node.js installation
- Both scripts verify backend is built before starting
- Both scripts start server and open browser automatically
- Mac/Linux script handles graceful shutdown with Ctrl+C

Scripts implement architecture.md specification (lines 600-635).
Tested on: [Windows/Mac/Linux - fill in your platform]

See Story 3.2 AC#4."
```
- [ ] Committed successfully
- [ ] Noted which platform was tested

**✅ PHASE 3 COMPLETE** - Take a 10-minute break!

---

## PHASE 4: CONFIGURATION STANDARDIZATION (1 hour)

### Decision: Database Location
**Choose one option and execute:**

**Option A: Match architecture (data/smeta.db)** - RECOMMENDED
```bash
# Create data directory if it doesn't exist
mkdir -p data/

# Move database if it exists in backend/
if [ -f backend/database.db ]; then
    mv backend/database.db data/smeta.db
    echo "✅ Database moved to data/smeta.db"
else
    echo "⚠️  No database found at backend/database.db (may not exist yet)"
fi

# Update backend/src/database/db.ts
# Change database path to: ../data/smeta.db
# (Manual edit required - see story for details)

# Test database connection
cd backend
npm run dev
# Verify: Server starts without database errors
# Stop server (Ctrl+C)
cd ..
```

**Option B: Update architecture to match reality**
```bash
# Edit docs/architecture.md
# Update all references: data/smeta.db → backend/database.db
# Add note explaining why database is in backend/
```

**Which option did you choose?**
- [ ] Option A: Moved database to data/smeta.db (RECOMMENDED)
- [ ] Option B: Updated architecture.md

### Standardize Port Configuration to 5001
```bash
# Update docs/architecture.md
# Find all references to port 5000 and change to 5001

# Add architectural decision note to architecture.md
# (Add after line with port specification):

echo "Add this note to architecture.md after port config:"
cat << 'EOF'

### Port Configuration Note

**Architectural Decision:** Port changed from 5000 to 5001

**Rationale:** 
- Port 5000 conflicts with macOS AirPlay Receiver service
- Port 5001 avoids common conflicts on all platforms
- Change is configuration-only, no business logic affected

**Date:** [Today's date]
**Impact:** Minimal - environment variable change only
EOF
```
- [ ] Updated port references in architecture.md (5000 → 5001)
- [ ] Added architectural decision note
- [ ] Verified backend/.env has PORT=5001
- [ ] Verified frontend .env has VITE_API_URL with port 5001

### Update Architecture Tech Stack Table
```bash
# Edit docs/architecture.md
# Find the tech stack table (around line 173-208)
# Add row for unzipper dependency:

echo "Add this row to tech stack table in architecture.md:"
cat << 'EOF'
| **File Unzip** | unzipper | 0.10.14 | Extract KPI report zip files | Enables bulk upload of KPI dashboards as single zip archive; extracts and processes contents automatically |
EOF
```
- [ ] Added unzipper to tech stack table
- [ ] Added clear purpose and rationale

### Update README.md Configuration Section
```bash
# Edit README.md
# Add/update configuration section

echo "Ensure README.md has this configuration section:"
cat << 'EOF'
## Configuration

### Environment Variables

**Backend (.env in backend/):**
```env
PORT=5001                    # API server port
NODE_ENV=production          # Environment mode
DB_PATH=../data/smeta.db     # SQLite database path
UPLOAD_DIR=./uploads         # Document storage directory
MAX_FILE_SIZE=52428800       # Max file size (50MB)
```

**Frontend (.env in frontend/):**
```env
VITE_API_URL=http://localhost:5001/api    # Backend API endpoint
VITE_APP_NAME="SMETA Compliance Platform"  # Application name
```

### Port Configuration
The application runs on **port 5001** to avoid conflicts with system services (notably macOS AirPlay Receiver on port 5000).
EOF
```
- [ ] README.md configuration documented
- [ ] Port choice explained

### Commit Phase 4
```bash
git add -A
git status

git commit -m "docs: Standardize configuration and update documentation

Configuration Changes:
- Standardize port to 5001 across all configs and docs
- [Option A: Move database to data/smeta.db per architecture]
  OR [Option B: Update architecture to reflect backend/database.db]
- Document port choice rationale (macOS AirPlay conflict)

Documentation Updates:
- Update architecture.md tech stack with unzipper dependency
- Add architectural decision note for port change
- Update README.md with comprehensive configuration section
- Document environment variables for both backend and frontend

All configuration now matches between implementation and documentation.

See Story 3.2 AC#5 and AC#8."
```
- [ ] Committed successfully
- [ ] Configuration is consistent

**✅ PHASE 4 COMPLETE**

---

## PHASE 5: RESOURCES DIRECTORY RESOLUTION (30 min)

### Investigate Resources Directory

**Question for Product Owner or Team:**
```
The resources/ directory contains Cretamel company data:
- Culture insights reports
- Climate surveys  
- SMETA evidence examples
- PDF reports in Greek

Question: Is this data:
A) Test/sample data for development?
B) Real client data (privacy concern)?
C) Required application resources?

Please advise before proceeding with Phase 5.
```

**Record answer here:** ___________________________________

### Based on Answer, Execute Appropriate Action:

#### If Answer is A (Test/Sample Data):
```bash
# Create test data directory
mkdir -p test-data/cretamel-samples/

# Move resources to test data
mv resources/* test-data/cretamel-samples/

# Remove empty resources directory
rmdir resources/

# Update README.md
echo "Add to README.md:"
cat << 'EOF'
## Test Data

The `test-data/cretamel-samples/` directory contains sample Cretamel company data for testing:
- Culture Insights reports (HTML packages)
- Climate surveys (interactive dashboards)
- SMETA evidence examples
- Sample PDF reports

This data is used for:
- Testing document upload functionality
- Demonstrating the platform to stakeholders
- Training new users
EOF
```
- [ ] Resources moved to test-data/cretamel-samples/
- [ ] Duplicates removed (kept only one version)
- [ ] Documented in README.md

#### If Answer is B (Real Client Data):
```bash
# DELETE immediately (DO NOT COMMIT)
rm -rf resources/

# Add to .gitignore
echo "resources/" >> .gitignore

# Document removal
echo "Real client data removed from repository for privacy compliance."
echo "Added resources/ to .gitignore to prevent future commits."
echo "Team notified of data privacy policy."
```
- [ ] Resources deleted
- [ ] Added to .gitignore
- [ ] Team notified

#### If Answer is C (Required Resources):
```bash
# Keep in place
# Update README.md to document purpose

echo "Add to README.md:"
cat << 'EOF'
## Application Resources

The `resources/` directory contains required application resources:
[Document specific purpose here - e.g., example reports, templates, etc.]

**Purpose:** [Explain why these files are needed]
**Do not delete:** These files are required for the application to function.
EOF
```
- [ ] Resources kept in place
- [ ] Purpose documented in README.md
- [ ] Team agrees resources are necessary

### Commit Phase 5
```bash
# Commit message depends on which action was taken

# If test data:
git add -A
git commit -m "refactor: Move Cretamel data to test-data/ directory

- Move resources/ contents to test-data/cretamel-samples/
- Remove duplicate versions (kept most recent Culture Insights)
- Document test data purpose in README.md

Rationale: Test/sample data should be organized in test-data/
rather than a generic resources/ directory.

See Story 3.2 AC#6."

# If real client data (DELETE):
git add .gitignore
git commit -m "security: Remove client data and prevent future commits

- Delete resources/ directory (contained real client data)
- Add resources/ to .gitignore
- Team notified of data privacy policy

Rationale: Real client data should not be committed to repository
for privacy and security reasons.

See Story 3.2 AC#6."

# If required resources (KEEP):
git add README.md
git commit -m "docs: Document required application resources

- Document purpose of resources/ directory in README
- Clarify that resources are required for application
- [Add specific details about what resources are and why needed]

See Story 3.2 AC#6."
```
- [ ] Committed successfully
- [ ] Resources issue resolved

**✅ PHASE 5 COMPLETE**

---

## PHASE 6: GIT STATUS CLEANUP (1 hour)

### Review Modified Files
```bash
# See all modified files
git status

# Review each modified file
git diff backend/package.json
git diff backend/src/app.ts
git diff backend/src/database/db.ts
# ... etc for all modified files
```
- [ ] Reviewed all modified files
- [ ] Understand what each change does

### Categorize Changes

**Create three lists:**

**List A: Complete Features (ready to commit)**
```
Example:
- backend/src/routes/kpis.ts (KPI upload feature - complete)
- backend/package.json (added unzipper dependency)
- frontend/src/components/Footer.tsx (footer component - complete)
```

Your List A:
- _______________________________________
- _______________________________________
- _______________________________________

**List B: Temporary/Debugging (revert)**
```
Example:
- backend/src/app.ts (has console.log debugging)
- frontend/src/services/api.ts (test endpoint hardcoded)
```

Your List B:
- _______________________________________
- _______________________________________

**List C: Work in Progress (stash or branch)**
```
Example:
- frontend/src/components/NewFeature.tsx (half-built component)
```

Your List C:
- _______________________________________
- _______________________________________

### Commit Complete Features (List A)
```bash
# Commit related files together with meaningful messages

# Example for KPI feature:
git add backend/src/routes/kpis.ts \
        backend/package.json \
        backend/src/controllers/kpiController.ts

git commit -m "feat: Add KPI upload and unzip functionality

- Implement POST /api/kpis/upload endpoint
- Add unzipper dependency (v0.10.14) for zip file processing
- Extract uploaded KPI reports to uploads/kpis/ directory
- Store metadata in documents table with pillar='kpis'

Feature enables bulk upload of KPI dashboard packages as
single zip file, automatically extracting and organizing contents.

Related to Story 3.1."

# Example for Footer component:
git add frontend/src/components/Footer.tsx \
        frontend/src/components/layout/Footer.tsx \
        docs/stories/2.8-footer-component.md

git commit -m "feat: Add footer component with audit date display

- Create Footer component with copyright and version info
- Display audit date prominently (October 29, 2025)
- Responsive layout adapts to screen size
- Material-UI styling consistent with app theme

Footer adds professional touch and communicates audit readiness
to users.

Implements Story 2.8."

# Continue for all List A items
```
- [ ] All List A changes committed
- [ ] Each commit has clear message
- [ ] Related files grouped logically

### Revert Temporary Changes (List B)
```bash
# Revert debugging code and temp changes
git restore backend/src/app.ts
git restore frontend/src/services/api.ts
# ... etc for all List B items
```
- [ ] All List B changes reverted
- [ ] No temporary code remains

### Handle Work in Progress (List C)

**Option 1: Stash for later**
```bash
git stash push -m "WIP: New feature in progress" \
    frontend/src/components/NewFeature.tsx

git stash list  # Verify stashed
```

**Option 2: Create feature branch**
```bash
git stash  # Temporarily stash
git checkout -b feature/new-feature
git stash pop
git add .
git commit -m "WIP: New feature in progress"
git checkout feature/3.2-cleanup
```

- [ ] All List C items handled
- [ ] Either stashed or moved to feature branch

### Verify Clean Status
```bash
git status
# Expected: "working tree clean"

# If not clean, investigate and handle remaining files
```
- [ ] Git status shows "working tree clean"
- [ ] No uncommitted changes

### Commit Phase 6 (If cleanup notes needed)
```bash
# If you made significant decisions about what to keep/revert:
cat > .cleanup-decisions.md << EOF
# Story 3.2 Cleanup Decisions

## Committed Features
- [List what was committed and why]

## Reverted Changes
- [List what was reverted and why]

## Stashed/Branched
- [List WIP items and where they are]

## Notes
- [Any important context for future reference]
EOF

git add .cleanup-decisions.md
git commit -m "docs: Document cleanup decisions for Story 3.2"
```
- [ ] Cleanup decisions documented (if needed)

**✅ PHASE 6 COMPLETE** - Take a 10-minute break!

---

## PHASE 7: ENHANCED .GITIGNORE (30 min)

### Update .gitignore Comprehensively
```bash
# Create updated .gitignore
cat > .gitignore << 'EOF'
# ============================================
# SMETA Compliance Platform - .gitignore
# ============================================

# Dependency directories
node_modules/
.pnp/
.pnp.js

# Build outputs
dist/
build/
*.js.map
.cache/

# Environment files (keep .env.example)
.env
.env.local
.env.development
.env.production
.env.test

# Database files
data/*.db
data/*.db-shm
data/*.db-wal
backend/database.db
backend/*.db
*.sqlite
*.sqlite3

# Upload directory (user-uploaded documents)
backend/uploads/
uploads/

# Logs
logs/
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
lerna-debug.log*
pnpm-debug.log*

# OS generated files
.DS_Store
.DS_Store?
._*
.Spotlight-V100
.Trashes
ehthumbs.db
Thumbs.db
desktop.ini
$RECYCLE.BIN/

# IDE and editor files
.vscode/
.idea/
*.swp
*.swo
*.swn
*~
.project
.classpath
.settings/

# Temporary files
tmp/
temp/
*.tmp
*.temp
.temp/

# Test artifacts and debugging
test-*.txt
test-*.sh
*-test.log

# Electron build artifacts
.electron-temp/
*-electron-*.sh
electron-frontend.env
electron-builder.yml
electron-out/
electron-dist/

# Debugging scripts (one-off fixes)
*-fix.js
*-fix.sh
sync-*.js
debug-*.js

# Coverage and test reports
coverage/
.nyc_output/
junit.xml

# Optional: Resources directory
# Uncomment if resources/ determined to be temporary
# resources/

# macOS specific
.AppleDouble
.LSOverride
Icon
.DocumentRevisions-V100
.fseventsd
.TemporaryItems
.VolumeIcon.icns
.com.apple.timemachine.donotpresent

# Windows specific
[Tt]humbs.db
[Dd]esktop.ini
$RECYCLE.BIN/
*.cab
*.msi
*.msix
*.msm
*.msp
*.lnk

# Linux specific
*~
.fuse_hidden*
.directory
.Trash-*
.nfs*
EOF
```
- [ ] .gitignore updated with comprehensive patterns
- [ ] All categories covered

### Test .gitignore Patterns
```bash
# Test that patterns work correctly

# Test 1: Test artifacts
touch test-debug.txt
git status | grep test-debug.txt
# Should NOT appear
rm test-debug.txt

# Test 2: Fix scripts
touch debug-fix.js
git status | grep debug-fix
# Should NOT appear
rm debug-fix.js

# Test 3: Database files
touch backend/database.db
git status | grep database.db
# Should NOT appear
rm backend/database.db

# Test 4: Node modules (if not already ignored)
mkdir -p temp-test/node_modules
touch temp-test/node_modules/test.js
git status | grep temp-test
# Should NOT appear
rm -rf temp-test/

echo "✅ All gitignore patterns working correctly"
```
- [ ] Test artifacts ignored
- [ ] Fix scripts ignored
- [ ] Database files ignored
- [ ] Node modules ignored
- [ ] All tests pass

### Commit Phase 7
```bash
git add .gitignore
git status

git commit -m "chore: Enhance .gitignore with comprehensive patterns

Added patterns for:
- Electron build artifacts (.electron-temp/, *-electron-*.sh)
- Temporary debugging scripts (*-fix.js, *-fix.sh, sync-*.js)
- Test artifacts (test-*.txt, test-*.sh)
- Extended OS-specific patterns (macOS, Windows, Linux)
- IDE files (.vscode/, .idea/, *.swp)
- Additional database patterns
- Build and dist directories
- Coverage reports

Comprehensive .gitignore prevents accidental commits of:
- Temporary debugging files
- Platform-specific files
- Generated build outputs
- User data (uploads, databases)

See Story 3.2 AC#9."
```
- [ ] Committed successfully
- [ ] All patterns documented in commit message

**✅ PHASE 7 COMPLETE**

---

## PHASE 8: BMAD FRAMEWORK CLEANUP (15 min)

### Remove Brownfield Templates
```bash
# Remove inapplicable templates (project is greenfield)
rm -f .bmad-core/templates/brownfield-architecture-tmpl.yaml
rm -f .bmad-core/templates/brownfield-prd-tmpl.yaml

# Remove obsolete documentation
rm -f .bmad-core/working-in-the-brownfield.md
rm -f .bmad-core/enhanced-ide-development-workflow.md

# Verify deletion
ls .bmad-core/templates/ | grep brownfield
# Should return nothing

ls .bmad-core/ | grep -E '(brownfield|enhanced-ide)'
# Should return nothing
```
- [ ] Brownfield templates removed
- [ ] Obsolete docs removed
- [ ] Verified deletion

### Verify Remaining Templates
```bash
# List remaining templates
ls -1 .bmad-core/templates/

# Should show only applicable templates:
# - story-tmpl.yaml
# - architecture-tmpl.yaml (greenfield)
# - prd-tmpl.yaml (greenfield)
# - competitor-analysis-tmpl.yaml
# - front-end-architecture-tmpl.yaml
# - etc.
```
- [ ] Listed remaining templates
- [ ] All remaining are applicable
- [ ] No brownfield-specific files

### Check core-config.yaml
```bash
# Review core-config.yaml for references to deleted files
cat .bmad-core/core-config.yaml

# Look for references to:
# - brownfield templates
# - enhanced-ide-development-workflow.md

# If found, remove those lines
# (Manual edit if needed)
```
- [ ] Reviewed core-config.yaml
- [ ] No references to deleted files
- [ ] Configuration is accurate

### Commit Phase 8
```bash
git add -A
git status

git commit -m "chore: Clean up BMAD framework - remove brownfield templates

- Remove brownfield-architecture-tmpl.yaml
- Remove brownfield-prd-tmpl.yaml
- Remove working-in-the-brownfield.md
- Remove enhanced-ide-development-workflow.md

Rationale: This project is explicitly greenfield (per PRD line 29).
Brownfield-specific templates and documentation are not applicable
and add unnecessary clutter to the .bmad-core/ directory.

Remaining templates are all applicable to this project.

See Story 3.2 AC#10."
```
- [ ] Committed successfully
- [ ] Only applicable templates remain

**✅ PHASE 8 COMPLETE**

---

## PHASE 9: COMPREHENSIVE TESTING (1 hour)

### Fresh Clone Test (CRITICAL)
```bash
# Navigate to temporary location
cd /tmp

# Clone your feature branch
git clone -b feature/3.2-cleanup <your-repo-url> smeta-cleanup-test
cd smeta-cleanup-test

# Verify branch
git branch
# Should show: * feature/3.2-cleanup

echo "✅ Fresh clone created"
```
- [ ] Cloned to /tmp/smeta-cleanup-test
- [ ] On correct branch
- [ ] Repository looks clean

### Follow README Installation
```bash
# Follow README.md instructions EXACTLY

# Step 1: Install root dependencies (if applicable)
npm install

# Step 2: Install backend dependencies
cd backend
npm install

# Check for errors
# If errors, note them and investigate

cd ..

# Step 3: Install frontend dependencies
cd frontend
npm install

# Check for errors
cd ..

echo "✅ Dependencies installed"
```
- [ ] Root install completed (or N/A)
- [ ] Backend install completed
- [ ] Frontend install completed
- [ ] No critical errors
- [ ] Any warnings are acceptable

### Test Development Mode
```bash
# Terminal 1: Start backend
cd backend
npm run dev

# Expected output:
# - TypeScript compiles successfully
# - Server starts on port 5001
# - "Server listening on port 5001" message
# - Database connects successfully
# - No error messages

# Leave running, open new terminal for frontend
```
- [ ] Backend compiles without errors
- [ ] Backend starts on port 5001
- [ ] Database connection successful
- [ ] No error messages in console

```bash
# Terminal 2: Start frontend
cd frontend
npm run dev

# Expected output:
# - Vite dev server starts on port 3000
# - No compilation errors
# - Opens browser automatically

# Leave running for testing
```
- [ ] Frontend compiles without errors
- [ ] Vite starts on port 3000
- [ ] Browser opens automatically
- [ ] No error messages

### Test Development Mode Functionality
```bash
# In browser at http://localhost:3000

# Test 1: Dashboard loads
# ✅ Dashboard displays with 6 cards
# ✅ Document counts show (may be 0 if fresh)
# ✅ No console errors in browser dev tools

# Test 2: Upload a document
# ✅ Click Upload button
# ✅ Modal opens
# ✅ Select file (use any PDF/DOCX)
# ✅ Choose Pillar 1, Category: Policies
# ✅ Click Upload
# ✅ Success message appears
# ✅ Document count increases

# Test 3: View document
# ✅ Click Pillar 1 card
# ✅ Policies tab shows uploaded document
# ✅ Click View icon
# ✅ PDF viewer opens (or download for DOCX)
# ✅ Document displays correctly

# Test 4: Search
# ✅ Type document name in search bar
# ✅ Press Enter
# ✅ Search results display
# ✅ Can click result to view document

# Test 5: CAPA
# ✅ Click CAPA card from dashboard
# ✅ CAPA tracker loads
# ✅ Click "Add CAPA" button
# ✅ Form opens
# ✅ Can create a CAPA record

# Stop both servers (Ctrl+C in both terminals)
```
- [ ] Dashboard loads correctly
- [ ] Can upload document
- [ ] Can view document
- [ ] Search works
- [ ] CAPA tracker works
- [ ] No errors in browser console
- [ ] No errors in backend console

### Test Production Build
```bash
# From project root (/tmp/smeta-cleanup-test)

# Build frontend
cd frontend
npm run build

# Expected:
# - Vite builds successfully
# - Creates dist/ directory
# - Shows bundle sizes
# - No errors

ls -la dist/
# Should show: index.html, assets/, etc.

cd ..
```
- [ ] Frontend builds successfully
- [ ] dist/ directory created
- [ ] No build errors
- [ ] Bundle sizes reasonable

```bash
# Build backend
cd backend
npm run build

# Expected:
# - TypeScript compiles successfully
# - Creates dist/ directory
# - No errors

ls -la dist/
# Should show: server.js and other compiled files

cd ..
```
- [ ] Backend builds successfully
- [ ] dist/ directory created
- [ ] No compilation errors

### Test Production Script (Windows)
**If on Windows:**
```bash
# From project root
# Double-click START_PLATFORM.bat

# OR run from command line:
START_PLATFORM.bat

# Expected:
# - Node.js version check passes
# - Backend build check passes
# - Server starts in minimized window
# - Browser opens to http://localhost:5001
# - Dashboard loads
# - All functionality works

# Test same scenarios as dev mode:
# - Upload document
# - View document
# - Search
# - CAPA

# Close server window when done
```
- [ ] Script runs successfully (or marked N/A for non-Windows)
- [ ] Server starts
- [ ] Browser opens
- [ ] Dashboard loads
- [ ] All functionality works

### Test Production Script (Mac/Linux)
**If on Mac/Linux:**
```bash
# From project root
./start-platform.sh

# Expected:
# - Node.js version check passes
# - Backend build check passes
# - Server starts (shows PID)
# - Browser opens to http://localhost:5001
# - Dashboard loads
# - All functionality works

# Test same scenarios as dev mode:
# - Upload document
# - View document
# - Search
# - CAPA

# Press Ctrl+C to stop when done
```
- [ ] Script runs successfully (or marked N/A for non-Mac/Linux)
- [ ] Server starts
- [ ] Browser opens
- [ ] Dashboard loads
- [ ] All functionality works
- [ ] Ctrl+C stops server gracefully

### Test API Endpoints Directly
```bash
# Health check
curl http://localhost:5001/api/health
# Expected: {"status":"ok"}

# Documents count (may be empty if fresh DB)
curl http://localhost:5001/api/documents/counts
# Expected: JSON with pillar/category structure

# CAPAs list
curl http://localhost:5001/api/capas
# Expected: [] or array of CAPA objects

# Search
curl "http://localhost:5001/api/search?q=test"
# Expected: [] or array of matching documents
```
- [ ] Health endpoint responds
- [ ] Documents count endpoint responds
- [ ] CAPAs endpoint responds
- [ ] Search endpoint responds
- [ ] All return valid JSON

### Verify No Broken References
```bash
# Search for references to deleted files
cd /tmp/smeta-cleanup-test

git grep "electron-temp"
# Expected: no results

git grep "build-electron" 
# Expected: no results

git grep "fix-pdf"
# Expected: no results

git grep "MERGE_COMPLETE" --exclude-dir=docs/process
# Expected: no results or only valid references

git grep "MERGE_STRATEGY" --exclude-dir=docs/process
# Expected: no results or only valid references
```
- [ ] No references to deleted electron scripts
- [ ] No references to deleted fix scripts
- [ ] No broken documentation links
- [ ] All file references are valid

### Clean Up Test Clone
```bash
# After all tests pass, clean up
cd /tmp
rm -rf smeta-cleanup-test

echo "✅ Test clone cleaned up"
```
- [ ] Test directory removed

**✅ PHASE 9 COMPLETE** - Almost done!

---

## PHASE 10: FINAL VALIDATION & DOCUMENTATION (30 min)

### Count Root Directory Files
```bash
# From your working branch (not test clone)
cd /Users/mbastakis/dev/personal/marvie-smeta

ls -1 | wc -l
# Expected: ≤ 12 files

# List root files
ls -1

# Should see approximately:
# .bmad-core/
# .electron-temp/ (should be DELETED)
# backend/
# docs/
# frontend/
# resources/ (may be moved/deleted)
# test-data/
# .gitignore
# AGENTS.md
# opencode.jsonc
# package-lock.json
# package.json
# README.md
# START_PLATFORM.bat (should exist now)
# start-platform.sh (should exist now)
# tsconfig.json

# Plus any other essential project files
```
- [ ] Root directory has ≤ 12 files
- [ ] Only essential files remain
- [ ] No clutter

### Verify Script Count
```bash
ls -1 *.sh 2>/dev/null
# Expected: Only start-platform.sh

ls -1 *.bat 2>/dev/null
# Expected: Only START_PLATFORM.bat

# Count total scripts
(ls -1 *.sh 2>/dev/null; ls -1 *.bat 2>/dev/null) | wc -l
# Expected: 2 (or 1 if on platform without .bat or .sh)
```
- [ ] Only start-platform scripts at root
- [ ] No electron scripts
- [ ] No fix/test scripts

### Verify Documentation Organization
```bash
ls -1 *.md
# Expected: README.md, AGENTS.md only

ls -1 docs/process/
# Expected: MERGE_COMPLETE.md, MERGE_STRATEGY.md, ELECTRON_IMPLEMENTATION_GUIDE.md
```
- [ ] Only README.md and AGENTS.md at root
- [ ] All process docs in docs/process/

### Architecture Alignment Checklist
```bash
# Review this checklist:

# ✅ START_PLATFORM.bat exists and works
# ✅ start-platform.sh exists and works
# ✅ Port configuration matches docs (5001)
# ✅ Database location matches architecture
# ✅ Tech stack table is complete (includes unzipper)
# ✅ Project structure matches specification
# ✅ All features documented in architecture.md
# ✅ PRD includes Epic 3 with stories 3.1, 3.2, 2.8-2.10
```
- [ ] All architecture alignment items checked
- [ ] Implementation matches documentation
- [ ] No drift between code and docs

### Update Story Status
```bash
# Edit docs/stories/3.2-project-cleanup-refactor.md
# Change status from "Draft" to "Complete"
# Add completion date to change log

git add docs/stories/3.2-project-cleanup-refactor.md
git commit -m "docs: Mark Story 3.2 as complete"
```
- [ ] Story marked as complete
- [ ] Completion date added

### Create Summary Document
```bash
cat > STORY-3.2-COMPLETION-SUMMARY.md << 'EOF'
# Story 3.2 Completion Summary

**Completed By:** [Your Name]
**Date:** [Today's Date]
**Time Spent:** [Actual hours] hours
**Branch:** feature/3.2-cleanup

## What Was Done

### Files Deleted (21 files + 1 directory)
- .electron-temp/ directory with all contents
- 10 electron build/launch scripts
- 5 PDF debugging scripts
- 3 test artifact files
- 3 brownfield BMAD templates

### Files Moved (3 files)
- MERGE_COMPLETE.md → docs/process/
- MERGE_STRATEGY.md → docs/process/
- ELECTRON_IMPLEMENTATION_GUIDE.md → docs/process/

### Files Created (2 scripts + documentation)
- START_PLATFORM.bat (Windows production launcher)
- start-platform.sh (Mac/Linux production launcher)
- Enhanced .gitignore
- This summary document

### Configuration Updates
- Standardized port to 5001
- [Database moved to data/smeta.db OR architecture updated]
- Updated all documentation to match reality

### Git Cleanup
- [X] commits created for completed features
- All temporary debugging code reverted
- Working tree is now clean

## Testing Results

✅ Fresh clone test: PASSED
✅ Development mode: PASSED
✅ Production build: PASSED
✅ Production script (Windows/Mac/Linux): [PASSED or N/A]
✅ All API endpoints: PASSED
✅ No broken references: PASSED

## Metrics

**Before Cleanup:**
- Root directory files: [count before]
- Shell scripts at root: [count before]
- Git uncommitted files: [count before]

**After Cleanup:**
- Root directory files: [count after]
- Shell scripts at root: [count after]
- Git uncommitted files: 0

**Improvement:**
- Root directory: [X]% reduction
- Scripts: [X]% reduction
- Git status: 100% clean

## Issues Encountered

[List any issues or blockers and how they were resolved]

## Notes for Team

[Any important information for the team]

## Ready for Review

This story is ready for:
- [ ] Architect review (Winston)
- [ ] Product Owner approval (Sarah)
- [ ] Code review
- [ ] Merge to main

---

**Status:** ✅ COMPLETE
EOF

git add STORY-3.2-COMPLETION-SUMMARY.md
git commit -m "docs: Add Story 3.2 completion summary"
```
- [ ] Summary document created
- [ ] All metrics filled in
- [ ] Issues documented
- [ ] Committed

**✅ PHASE 10 COMPLETE** - Story is finished!

---

## POST-COMPLETION CHECKLIST

### Review Your Work
- [ ] All 12 acceptance criteria met
- [ ] All 10 phases completed
- [ ] Git history is clean with meaningful commits
- [ ] No uncommitted changes (`git status` clean)
- [ ] Fresh clone test passed
- [ ] Production scripts work

### Prepare for Review
```bash
# Create summary of all commits
git log --oneline feature/3.2-cleanup ^main

# Push to remote
git push origin feature/3.2-cleanup

# Create pull request (if using GitHub/GitLab)
# Title: "Story 3.2: Repository Cleanup & Technical Debt Resolution"
# Description: Link to this story file and completion summary
```
- [ ] Reviewed all commits
- [ ] Pushed to remote
- [ ] Pull request created (or ready to merge)

### Request Reviews
- [ ] Tag Winston (Architect) for architecture review
- [ ] Tag Sarah (Product Owner) for approval
- [ ] Tag team for code review
- [ ] Notify team in Slack/chat

### Update Project Board
- [ ] Move Story 3.2 card to "Review" column
- [ ] Add completion date
- [ ] Add link to pull request
- [ ] Update story points (if actual differs from estimate)

---

## ✅ STORY 3.2 COMPLETE!

**Congratulations!** You've successfully cleaned up the repository and eliminated technical debt.

**Key Achievements:**
✅ Removed 21+ obsolete files
✅ Created production deployment scripts
✅ Organized documentation properly
✅ Standardized configuration
✅ Cleaned git history
✅ Enhanced .gitignore
✅ Aligned implementation with architecture
✅ Comprehensive testing passed

**Impact:**
- 70% reduction in root directory clutter
- 90% reduction in obsolete scripts
- 100% clean git working tree
- Professional repository appearance
- Easier developer onboarding
- Proper production deployment capability

**Next Steps:**
1. Wait for reviews and approval
2. Address any review feedback
3. Merge to main
4. Delete feature branch
5. Celebrate! 🎉

---

**Time Tracking:**

Actual time spent: _______ hours  
Estimated time: 4-6 hours  
Variance: _______ hours (over/under)

**Notes:**
[Add any final notes or lessons learned]

---

**END OF CHECKLIST**
